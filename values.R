library(stargazer)

options(digits=4)

n <- 20

# M --------------------------------------------------------------------------------------------------------------------------------------
M <- c(1:n)

# m* ------------------------------------------------------------------------------------------------------------------------------------
m_star <- floor(M/exp(1))

# M/e ------------------------------------------------------------------------------------------------------------------------------------
M_e <- M/exp(1)


# m* - 1 ---------------------------------------------------------------------------------------------------------------------------------
m_star_1 <- NULL
for (i in 1:n){
  
  m_star_1[i] <- max(0, m_star[i]-1)
  
}




# v_0 ------------------------------------------------------------------------------------------------------------------------------------

value <- NULL

value <- function(m,M){
  
  first_index <- m
  last_index <- M-1
  
  x <- seq(first_index, last_index)
  
  value <- (m/M)*sum(1/x)
  
  return(value)
}


values <- rep(NA, 20)
values[1] <- 1
values[2] <- 0.5
values[3] <- 0.5
values[4] <- 1/4 * (1 + (1/2) + (1/3))
values[5] <- 1/5 * (1 + (1/2) + (1/3) + (1/4))
  
for(i in 6:n){
  
  values[i] <- value(m_star_1[i], M[i])
  
}

# tbl ------------------------------------------------------------------------------------------------------------------------------------

tbl <- cbind(M, M_e, m_star, m_star_1, values)
View(tbl)



M50 <- c(50, (50/exp(1)), floor(50/exp(1)), (floor(50/exp(1))-1), value((floor(50/exp(1))-1), 50))

M100 <- c(100, (100/exp(1)), floor(100/exp(1)), (floor(100/exp(1))-1), value((floor(100/exp(1))-1), 100))

M300 <- c(300, (300/exp(1)), floor(300/exp(1)), (floor(300/exp(1))-1), value((floor(300/exp(1))-1), 300))

View(rbind.data.frame(tbl, M50, M100, M300))

as.matrix(rbind.data.frame(tbl, M50, M100, M300))

stargazer(as.matrix(rbind.data.frame(tbl, M50, M100, M300)))
